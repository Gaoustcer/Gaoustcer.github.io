---
layout:     post
title:      计算机体系结构——推断执行
subtitle:   计算机体系结构——推断执行
date:       2021-05-27
author:     Haihan Gao
header-img: img/post-bg-swift2.jpg
catalog: true
tags:
    - Computer Architecture
    - Course review
---
# 计算机体系结构——推断执行

## 基于硬件的推测

### 基本思想

* 用动态分支预测选择需要执行哪些指令
* 利用硬件推测，消除错误推测序列的影响
* 进行动态调度，应对基本模块不同组合方式的调度
* 根据预测的数据流值选择何时执行指令，称之为数据流执行，操作数一旦可用就立即进行执行运算

### 增加指令提交步骤

* 乱序执行，顺序提交
* 防止指令提交前采取任何不可晚会的动作(更新机器状态)
* 增加硬件缓冲区，存储执行完但是没有提交的指令->重排序缓冲区ROB

### ROB

* 指令类型
  * 分支、存储、寄存器操作
* 目的地字段
  * 目的寄存器编号(载入指令与ALU运算)
* 值字段
  * 指令提交之前保存结果值
* 就绪字段
  * 正在执行中
  * 执行完毕(Ready)
  * 提交
* ROB中的指令按照程序逻辑顺序

### 指令执行步骤

#### 发射

##### 进入发射阶段的条件

* 存在空保留站
* ROB存在空插槽

##### 进入发射阶段的行为

* 修改保留站状态，保留站忙
* 进行旁路，寄存器或ROB中含有操作数，就将其发送至保留站

#### 执行

##### 进入执行阶段的条件

* 所有操作数均为可用，如果存在操作数不可用则监视CDB，检查RAW冒险
* 可能占用多个时钟周期

##### 行为

载入指令需要计算有效地址，只需要等待基址寄存器可用

#### 写结果

结果可用的时候，写到CDB上，将保留站标记为可用

#### 提交

分为三种情况

* 提交的指令是预测错误的分支:修改ROB队首指针
* 存储指令:更新存储器
* 正常提交